#include "AudioOutputBackend.h"
#include "AudioOutputBackend_p.h"
#include "Factory.h"

NAMESPACE_BEGIN

FACTORY_DEFINE(AudioOutputBackend)

AudioOutputBackend::AudioOutputBackend(AudioOutputBackendPrivate* p):
    d_ptr(p)
{

}

AudioOutputBackend::~AudioOutputBackend()
{

}

std::vector<std::string> AudioOutputBackend::defaultPriority()
{
    static std::vector<std::string> backends;

#ifdef SMI_HAVE_XAUDIO
    //XAudio is recommended for windows
    backends.push_back("XAudio");
#endif
#ifdef SMI_HAVE_PORTAUDIO
    backends.push_back("PortAudio");
#endif
#ifdef SMI_HAVE_DSOUND
    backends.push_back("Directsound");
#endif

    return backends;
}

bool AudioOutputBackend::avaliable() const
{
    DPTR_D(const AudioOutputBackend);
    return d->avaliable;
}

void AudioOutputBackend::setAvaliable(bool b)
{
    DPTR_D(AudioOutputBackend);
    d->avaliable = b;
}

void AudioOutputBackend::setFormat(const AudioFormat &fmt)
{
    DPTR_D(AudioOutputBackend);
    d->format = fmt;
}

void AudioOutputBackend::setBufferSize(int size)
{
    d_func()->buffer_size = size;
}

void AudioOutputBackend::setBufferCount(int count)
{
    d_func()->buffer_count = count;
}

const AudioFormat *AudioOutputBackend::format()
{
    DPTR_D(const AudioOutputBackend);
    return &d->format;
}

NAMESPACE_END
